<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Use UglifyJS To Automatically Strip console.log() From Your Production JavaScript</title>
    <meta name="viewport" content="width=device-width">

    <link rel="shortcut icon" href="/favicon.ico?v=3"/>
    <link rel="apple-touch-icon" href="/assets/images/apple-touch-icon.png"/>
    <link rel="apple-touch-icon" sizes="57x57" href="/assets/images/apple-touch-icon-57x57.png"/>
    <link rel="apple-touch-icon" sizes="72x72" href="/assets/images/apple-touch-icon-72x72.png"/>
    <link rel="apple-touch-icon" sizes="114x114" href="/assets/images/apple-touch-icon-114x114.png"/>
    <link rel="apple-touch-icon" sizes="144x144" href="/assets/images/apple-touch-icon-144x144.png"/>
    <link rel="apple-touch-icon" sizes="57x57" href="/assets/images/apple-touch-icon-60x60.png"/>
    <link rel="apple-touch-icon" sizes="72x72" href="/assets/images/apple-touch-icon-120x120.png"/>
    <link rel="apple-touch-icon" sizes="114x114" href="/assets/images/apple-touch-icon-76x76.png"/>
    <link rel="apple-touch-icon" sizes="144x144" href="/assets/images/apple-touch-icon-152x152.png"/>

    
    <link rel="stylesheet" href="/css/syntax.css">
    <link rel="stylesheet" href="/css/main.css">

    <script type="text/javascript" src="/js/modernizr.custom.15501.js"></script>
    <script type="text/javascript" src="/js/picturefill_matchmedia.js"></script>
    <script type="text/javascript" src="//use.typekit.net/sje1dhr.js"></script>
    <script type="text/javascript">
      try {
        Typekit.load({
          active: function () {
          }
        })
      } catch (e) {
        console.log(e);
      }
    </script>
    
  </head>
  <body>
    <div id="topStripe" class="stripe"></div>

    <header class="tk-omnes-pro">
      <div class="container">

        <h1>John Starr Dewar</h1>

        <div id="pic">
        </div>
        <div id="nav">
          <a href="/about">About</a>
          <a href="/">Posts</a>
          <a href="http://www.123contactform.com/form-724791/Email-Me">Email</a>
          <a href="/follow">Follow</a>
        </div>
      </div>

    </header>

    <div id="topMargin" class="margin"></div>


    <div id="main" class="container">

      <div class="site tk-freight-sans-pro">
        <div id="home">
  <h2>Use UglifyJS To Automatically Strip console.log() From Your Production JavaScript</h2>

  <div class="list-date">28 Feb 2013</div>
</div>

<div class="post">
  <p>Oftentimes, you want to include a lot of <code>console.log()</code> statements while you are developing your app.  Most of these will be removed before deployment, but it isn&#39;t always convenient to remove all of them.  There are useful messages that illuminate what&#39;s happening, like log statements in AJAX responses and module initializations.  If you remove them all and a bug is discovered in your production code, you&#39;ll have to go and put them back in â€“ that&#39;s not staying very DRY.</p>

<p>Of course, you could just leave the <code>console.log</code> statements in the code.  There are two problems with that. The first problem is Internet Explorer.  In IE 8, <code>console</code> is only defined when the Developer Tools panel is open.  (That just seems like a cruel trick; you won&#39;t see any errors caused by missing <code>console</code> objects when you open the dev tools to find out why your code doesn&#39;t work.)  You can get around that by including your own <code>console</code> shim.  One is included in HTML5 Boilerplate.  </p>

<p>That brings us to problem #2.  There is a performance cost to having the browser catching log events.  Usually this won&#39;t really make any appreciable difference, unless you have a log message in a big loop somewhere, but it&#39;s something to be aware of.</p>

<p>If you have a minification step, UglifyJS will afford you a better solution. The following technique is now pretty clearly documented in the UglifyJS ReadMe.  Yet perhaps because it was a bit confusing before, most people that I know weren&#39;t aware that you could do this.</p>

<p>The trick is that you can define constants while minifying.  For example, this command...</p>

<p><code>uglifyjs --define DEBUG=false &quot;main.js&quot; &gt; &quot;main.min.js&quot;</code></p>

<p>...Adds a temporary constant called DEBUG that evaluates to false. So if in your code you write...</p>
<div class="highlight"><pre><code class="js language-js" data-lang="js"><span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">DEBUG</span> <span class="o">===</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="nx">DEBUG</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span> <span class="c1">// will be removed</span>

<span class="kd">function</span> <span class="nx">doSomethingCool</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">DEBUG</span> <span class="o">&amp;&amp;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;something cool just happened&quot;</span><span class="p">);</span> <span class="c1">// will be removed</span>
<span class="p">}</span>
</code></pre></div>
<p>...The log message line will be removed by Uglify&#39;s dead-code remover (since it will erase any conditional that will always evaluate to false).  So will that first conditional.  But when you are testing as uncompressed code, DEBUG will start out undefined, the first conditional will set it to true, and all your console.log() messages will work.</p>

<p>There is a new version of UglifyJS now called UglifyJS2.  Its behavior is a bit different.  In order to get the dead-code remover to work, you have to activate the compressor.  So the command is now:</p>

<p><code>uglifyjs --compress --define DEBUG=false main.js -o main.min2.js</code></p>

<p><em>Related Posts:</em></p>

<p><a href="/blog/2013/11/14/introducing-adhesive/">Introducing Adhesive</a></p>

</div>
<div id="share">
  <a href="https://twitter.com/share" class="twitter-share-button" data-via="jstarrdewar" data-size="large"
     data-count="none">Tweet</a>

  <div style="float:right">
    <div class="g-plusone" data-annotation="none"></div>

  </div>
</div>


<div id="disqus_thread"></div>

<script type="text/javascript">
  var disqus_shortname = 'jstarrdewar-blog';
  var disqus_identifier = '/blog/2013/02/28/use-uglify-to-automatically-strip-debug-messages-from-your-javascript/';
  var disqus_url = 'http://jstarrdewar.com/blog/2013/02/28/use-uglify-to-automatically-strip-debug-messages-from-your-javascript/';

  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function () {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<!-- Place this tag after the last +1 button tag. -->
<script type="text/javascript">
  (function () {
    var po = document.createElement('script');
    po.type = 'text/javascript';
    po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(po, s);
  })();
</script>

<script>!function (d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0], p = /^http:/.test(d.location) ? 'http' : 'https';
  if (!d.getElementById(id)) {
    js = d.createElement(s);
    js.id = id;
    js.src = p + '://platform.twitter.com/widgets.js';
    fjs.parentNode.insertBefore(js, fjs);
  }
}(document, 'script', 'twitter-wjs');</script>
      </div>
    </div>
    <div id="bottomMargin" class="margin"></div>
    <div id="bottomStripe" class="stripe"></div>
    <script type="text/javascript">
      var topStripe = document.getElementById("bottomStripe");
      var topMargin = document.getElementById("bottomMargin");
      var mainContent = document.getElementById("main");
      var bottomStripe = document.getElementById("bottomStripe");
      var bottomMargin = document.getElementById("bottomMargin");

      var decorationHeight = topStripe.offsetHeight + topMargin.offsetHeight + bottomStripe.offsetHeight;
      var bottomMarginHeight = bottomMargin.offsetHeight;

      var seconds = 0;

      function checkHeight() {
        setTimeout(function () {
          var totalHeight = decorationHeight + mainContent.offsetHeight;

          if (totalHeight + bottomMarginHeight < window.innerHeight) {
            if (window.innerHeight - totalHeight < 0) {
              bottomMargin.style.height = "2rem";
            } else {
              bottomMargin.style.height = (window.innerHeight - totalHeight) + "px";

            }
          }
          if (seconds < 30) {
            seconds++;
            checkHeight();
          }
        }, 1000);
      }
      checkHeight();


    </script>
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-8569918-1']);
      _gaq.push(['_trackPageview']);

      (function () {
        var ga = document.createElement('script');
        ga.type = 'text/javascript';
        ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(ga, s);
      })();

    </script>

  </body>
</html>
